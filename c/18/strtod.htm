<!DOCTYPE HTML>
<html lang="ru">
<head>
<title>Функция strtod - cправочник по Си</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../work/css.css">
</head><body>
<a href="../main.htm#18">Содержание</a> | <a href="18.htm#00">Глава 18</a><hr>
<h1>Функция strtod</h1>
<pre>
#include &lt;stdlib.h&gt;
double strtod(const char *<em>start</em>, char **<em>end</em>);
</pre>
<p class="tj">Функция <kbd>strtod()</kbd> преобразует строковое представление числа, которое содержится в строке, адресуемой параметром <em>start</em>, в значение типа <kbd>double</kbd> и возвращает полученный результат.
<p class="tj">В версии С99 к параметрам <em>start</em> и <em>end</em> применен квалификатор <kbd>restrict</kbd>.
<p class="tj">Функция <kbd>strtod()</kbd> работает следующим образом:
<p class="tj">Сначала в строке, адресуемой параметром <em>start</em>, пропускаются пробелы, символы табуляции и пустой строки. Затем считываются символы, составляющие число. Когда считывается символ, который не может встречаться в записи числа с плавающей точкой, считывание прекращается. К таким символам относятся пробелы, символы табуляции и пустой строки, знаки препинания (но не точки) и символы, отличные от букв "Е" и "е". Наконец, параметр-указатель <em>end</em> устанавливается так, чтобы указывать на "неиспользованный" остаток исходной строки, если таковой существует. Это означает, что, если функция <kbd>strtod()</kbd> вызывается с аргументом <pre>"100.00 плоскогубцев"</pre><p class="t">то она возвратит значение <pre>100.00</pre><p class="t">а параметр-указатель <em>end</em> будет указывать на пробел, предшествующий слову <pre>"плоскогубцев"</pre>
<p class="tj">При возникновении переполнения функция <kbd>strtod()</kbd> возвращает либо значение <kbd>HUGE_VAL</kbd>, либо значение <kbd>-HUGE_VAL</kbd> (означающее положительное или отрицательное переполнение соответственно), а глобальная переменная <kbd>errno</kbd> устанавливается равной значению <kbd>ERANGE</kbd>, свидетельствующему об ошибке из-за выхода результата за пределы представимых чисел. При потере значимости возвращается нуль, а глобальная переменная <kbd>errno</kbd> устанавливается равной значению <kbd>ERANGE</kbd>. Если параметр <em>start</em> не указывает на число, никакого преобразования не выполняется и функция возвращает нуль.
<h2>Пример</h2>
<p class="tj">Следующая программа читает числа с плавающей точкой из массива символов.
<pre>
#include &lt;stdlib.h&gt;
#include &lt;ctype.h&gt;
#include &lt;stdio.h&gt;
int main(void)
{
  char *end, *start = "100.00 плоскогубцев 200.00 молотков";
  end = start;
  while(*start) {
    printf("%f, ", strtod(start, &end));
    printf("Остаток: %s\n" ,end);
    start = end;
    /* пропускает символы не входящие в числа */
    while(!isdigit(*start) && *start) start++;
  }
  return 0;
}
</pre>
<p class="tj">Вот что выводит эта программа:
<pre>100.000000, Остаток: плоскогубцев 200.00 молотков
200.000000, Остаток: молотков</pre>
<h2>Зависимые функции</h2>
<a href="atof.htm">atof()</a>  <a href="strtold.htm">strtold()</a>  <a href="strtof.htm">strtof()</a>
<p>
</p>
<hr><a href="../main.htm#18">Содержание</a> | <a href="18.htm#00">Глава 18</a>
</body>
</html>
