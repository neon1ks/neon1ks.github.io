<!DOCTYPE HTML>
<html lang="ru">
<head>
<title>Изменения препроцессора - cправочник по Си</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../work/css.css">
</head>
<body>


<a href="../main.htm#11">Содержание</a> | <a href="1107.htm">&lt;&lt;&lt;</a> | <a href="1109.htm">&gt;&gt;&gt;</a><hr>
<h1>Изменения препроцессора</h1>
<p class="tj">Стандарт С99 внес небольшие изменения и в препроцессор.
<h2>Переменные списки аргументов</h2>
<p class="tj">Возможно, самым важным изменением препроцессора является возможность обрабатывать макросы с переменным количеством аргументов. На переменное количество аргументов указывает многоточие (...),  находящееся  в определении макроса. Встроенный препроцессорный идентификатор <kbd>__VA_ARGS__</kbd> 	определяет, куда будут подставляться аргументы. Например, после включения в программу определения
<pre>#define MyMax(...) max(__VA_ARGS__)</pre>
<p>выражение
<pre>MyMax(a, b);</pre>
<p>преобразуется в
<pre>max(a, b);</pre>
<p class="tj">До обозначения переменного количества аргументов (...) макрос может иметь другие аргументы. Например, после определения
<pre>#define compare(compfunc, ...) compfunc(__VA_ARGS__)</pre>
<p>оператор
<pre>compare(strcmp, "один", "два");</pre>
<p>преобразуется в оператор
<pre>strcmp("один", "два");</pre>
<p class="tj">Как видно из примера, встроенный идентификатор <kbd>__VA_ARGS__</kbd> заменяется всеми остальными аргументами.
<h2>Оператор _Pragma</h2>
<p class="tj">С выходом С99 в языке С появился еще один способ определять прагму в программе: оператор <kbd>_Pragma</kbd>. В общем виде этот оператор выглядит таким образом:
<pre>_Pragma(<em>"директива"</em>)</pre>
<p class="tj">Здесь <em>директива</em> — это вызываемая <em>прагма</em><sup><a href="#11" id="1">[1]</a></sup>. Появление оператора <kbd>_Pragma</kbd> дает прагмам возможность участвовать в макрозамене.
<h2>Встроенные прагмы</h2>
<p class="tj">
<table class="table table-bordered">
<tr><th>Прагма<th>Что означает
<tr><td>STDC&nbsp;FP_CONTRACT&nbsp;ON/OFF/DEFAULT<td class="t">Во включенном состоянии (ON) выражения с плавающей точкой считаются неделимыми структурами, которые обрабатываются с помощью аппаратуры. Состояние по умолчанию (DEFAULT) определяется реализацией.
<tr><td>STDC&nbsp;FENV_ACCESS&nbsp;ON/OFF/DEFAULT<td class="t">Сообщает компилятору, что доступна аппаратура для выполнения операций с плавающей точкой. Состояние по умолчанию определяется реализацией.
<tr><td>STDC&nbsp;CX_LIMITED_RANGE&nbsp;ON/OFF/DEFAULT<td class="t">Во включенном состоянии (ON)сообщает компилятору, что некоторые формулы с составными значениями являются безопасными. Отключенное состояние (OFF) задается по умолчанию.
</table>
<p class="tj">Подробные сведения об этих прагмах должны быть приведены в документации по компилятору.
<h2>Новые встроенные макросы</h2>
<p class="tj">К макросам, поддерживаемым С89, в С99 добавлены следующие:</p>
<table class="table table-bordered">
<tr><td>__STDC_HOSTED__<td class="t">1, если имеется операционная система
<tr><td>__STDC_VERSION__<td class="t">не меньше, чем 199901L; представляет версию языка С
<tr><td>__STDC_IЕС_559__<td class="t">1, если поддерживаются арифметические операции с плавающей запятой IEC 60559
<tr><td>__STDC_IEC_559_COMPLEX__<td class="t">1, если поддерживаются арифметические операции с комплексными числами IEC 60559
<tr><td>__STDC_ISO_10646__<td class="t">Значение в виде гггглшЬ, которое указывает год и месяц выхода спецификации ISO/IEC 10646, поддерживаемой компилятором
</table>
<p><img src="../work/sup.bmp" alt="----------">
<blockquote>
<p class="tj"><sup><a href="#1" id="11">[1]</a></sup><em>Прагма</em> называется также <em>указанием транслятору, псевдокомментарием, директивой транслятора, указанием компилятору, директивой компилятора</em>.
</blockquote>
<hr><a href="../main.htm#11">Содержание</a> | <a href="1107.htm">&lt;&lt;&lt;</a> | <a href="1109.htm">&gt;&gt;&gt;</a>


</body>
</html>
