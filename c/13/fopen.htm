<!DOCTYPE HTML>
<html lang="ru">
<head>
<title>Функция fopen - cправочник по Си</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../work/css.css">
</head>
<body>


<a href="../main.htm#13">Содержание</a> | <a href="13.htm#00">Глава 13</a><hr>
<h1>Функция fopen</h1>
<pre>
#include &lt;stdio.h&gt;
FILE *fopen(const char *<em>fname</em>, const char *<em>mode</em>);
</pre>
<p class="tj">Функция <kbd>fopen()</kbd> открывает файл, имя которого задается параметром <em>fname</em>, и возвращает указатель на поток, связанный с этим файлом. Типы операций, которые разрешено выполнять с файлом, определяются параметром <em>mode</em>. Возможные значения параметра <em>mode</em> приведены в таблице 13.1. Строка символов, которая будет играть роль имени реального файла, должна определять его имя, допустимое в данной операционной системе. Эта строка может включать спецификацию пути, если среда поддерживает такую возможность.
<p class="tj">В версии C99 к параметрам <em>fname</em> и <em>mode</em> применен квалификатор <kbd>restrict</kbd>.
<p class="tj">Если функция <kbd>fopen()</kbd> успешно открыла заданный файл, она возвращает указатель <kbd>FILE</kbd>. Если файл открыть не удается, возвращается нулевой указатель.</p>
<table class="table table-bordered">
<caption><strong>Таблица 13.1. Допустимые значения параметра <em>mode</em> функции <kbd>fopen()</kbd></strong></caption>
<tr><th><em>Режим</em><th><em>Назначение</em>
<tr><td>"r"<td>Открывает текстовый файл для чтения
<tr><td>"w"<td>Создает текстовый файл для записи
<tr><td>"а"<td>Дописывает в текстовый файл
<tr><td>"rb"<td>Открывает двоичный файл для чтения
<tr><td>"wb"<td>Создает двоичный файл для записи
<tr><td>"ab"<td>Дописывает в двоичный файл
<tr><td>"r+"<td>Открывает текстовый файл для чтения и записи
<tr><td>"w+"<td>Создает текстовый файл для чтения и записи
<tr><td>"а+"<td>Открывает текстовый файл для чтения и записи
<tr><td>"rb+" или "r+b"<td>Открывает двоичный файл для чтения и записи
<tr><td>"wb+" или "w+b"<td>Создает двоичный файл для чтения и записи
<tr><td>"ab+" или "а+b"<td>Открывает двоичный файл для чтения и записи
</table>
<p class="tj">Как видно из таблицы, файл можно открывать либо в текстовом, либо в двоичном режиме. В текстовом режиме выполняются преобразования некоторых символов. Например, символы новой строки преобразуются в комбинацию кодов возврата каретки (ASCII 13) и конца строки (ASCII 10). В двоичном режиме подобные преобразования не выполняются.
<p class="tj">В следующем фрагменте программы иллюстрируется корректный способ открытия файла.
<pre>
FILE *fp;
if ((fp = fopen("test", "w"))==NULL) {
  printf("He удается открыть файл.\n");
  exit(1);
}
</pre>
<p class="tj">Благодаря такому методу перед записью в файл выявляется любая ошибка, возникающая при его открытии, например, использование защищенного от записи или заполненного диска.
<p class="tj">Если с помощью функции <kbd>fopen()</kbd> открывается файл для вывода (записи), то любой уже существующий файл с заданным именем удаляется, а вместо него создается новый. Если файл с таким именем не существует, он будет создан. Чтобы открыть файл для выполнения операций чтения, нужно, чтобы этот файл уже существовал. В противном случае функция возвратит значение ошибки. Чтобы добавить данные в конец файла, необходимо использовать режим <kbd>"а"</kbd>. Если окажется, что указанный файл не существует, он будет создан.
<p class="tj">Осуществляя доступ к файлу, который открыт для чтения и записи, не следует сразу за операцией ввода выполнять операцию вывода, не прибегнув прежде к промежуточному вызову одной из следующих функций: <kbd>fflush()</kbd>, <kbd>fseek()</kbd>, <kbd>fsetpos()</kbd> или <kbd>rewind()</kbd>. Нельзя также сразу за операцией вывода выполнять операцию ввода, не прибегнув прежде к промежуточному вызову одной из перечисленных выше функций. Исключением является момент достижения конца файла во время операции ввода, т.e. в конце файла вывод может непосредственно следовать за вводом.
<p class="tj">Максимальное количество файлов, которые могут быть открыты одновременно, ограничивается значением <kbd>FOPEN_MAX</kbd>, определенным в заголовке <kbd>&lt;stdio.h&gt;</kbd>.
<h2>Пример</h2>
<p class="tj">Следующий фрагмент открывает файл с названием TEST для чтения-записи в двоичном режиме.
<pre>
FILE *fp;
if((fp=fopen("test", "rb+"))==NULL) {
  printf("He удается открыть файл.\n");
  exit(1);
}
</pre>
<h2>Зависимые функции</h2>
<a href="fclose.htm">fclose()</a>  <a href="fread.htm">fread()</a>  <a href="fwrite.htm">fwrite()</a>  <a href="putc.htm">putc()</a>  <a href="getc.htm">getc()</a>
<hr><a href="../main.htm#13">Содержание</a> | <a href="13.htm#00">Глава 13</a>


</body></html>