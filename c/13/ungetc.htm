<!DOCTYPE HTML>
<html lang="ru">
<head>
<title>Функция ungetc - cправочник по Си</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../work/css.css">
</head><body>
<a href="../main.htm#13">Содержание</a> | <a href="13.htm#00">Глава 13</a><hr>
<h1>Функция ungetc</h1>
<pre>
#include &lt;stdio.h&gt;
int ungetc(int <em>ch</em>, FILE *<em>stream</em>);
</pre>
<p class="tj">Функция <kbd>ungetc()</kbd> возвращает в поток ввода <em>stream</em> символ, заданный младшим байтом параметра <em>ch</em>. Затем этот символ будет получен при последующей операции чтения потока <em>stream</em>. Обращение к таким функциям, как <kbd>fflush()</kbd>, <kbd>fseek()</kbd> и <kbd>rewind()</kbd>, аннулирует действие <kbd>ungetc()</kbd> и сбрасывает этот символ.
<p class="tj">Гарантируется, что в поток можно возвратить один символ, однако некоторые реализации допускают возврат большего числа символов.
<p class="tj">Попытка вернуть в поток ввода значение <kbd>EOF</kbd> игнорируется.
<p class="tj">Обращение к функции <kbd>ungetc()</kbd> очищает признак конца файла, связанный с заданным потоком. Значение указателя текущей позиции файла для текстового потока не определено до тех пор, пока не будут прочитаны все возвращенные обратно в поток символы, в этом случае оно остается таким же, каким было до первого вызова функции <kbd>ungetc()</kbd>. При работе с потоками в двоичном режиме каждый вызов функции <kbd>ungetc()</kbd> уменьшает указатель текущей позиции файла.
<p class="tj">При успешном завершении функция возвращает значение <em>ch</em>, в противном случае — значение <kbd>EOF</kbd>.
<h2>Пример</h2>
<p class="tj">Данная функция читает слова из входного потока, адресуемого указателем <kbd>fp</kbd>. Разделитель возвращается в поток для последующего использования. Например, если входные данные имеют вид count/10, то при первом обращении к функции read_word() она возвратит count, a символ "/" направит обратно во входной поток.
<pre>
void read_word(FILE *fp, char *token)
{
  while(isalpha(*token=getc(fp))) token++;
  ungetc(*token, fp);
}
</pre>
<h2>Зависимые функции</h2>
<a href="getc.htm">getc()</a>
<p>
</p>
<hr><a href="../main.htm#13">Содержание</a> | <a href="13.htm#00">Глава 13</a>
</body></html>