<!DOCTYPE HTML>
<html lang="ru">
<head>
<title>Индексация указателей - cправочник по Си</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../work/css.css">
</head>
<body>


<a href="../main.htm#04">Содержание</a> | <a href="0406.htm">&lt;&lt;&lt;</a> | <a href="0408.htm">&gt;&gt;&gt;</a><hr>
<h1>Индексация указателей</h1>
<p class="tj">Указатели и массивы тесно связаны друг с другом. Имя массива без индекса — это указатель на первый (начальный) элемент массива. Рассмотрим, например, следующий массив:
<pre>char p[10];</pre>
<p class="tj">Следующие два выражения идентичны:
<pre>p
&p[0]</pre>
<p class="tj">Выражение
<pre>p == &p[0]</pre>
<p class="t">принимает значение ИСТИНА, потому что адрес 1-го элемента массива — это то же самое, что и адрес массива.
<p class="tj">Как уже указывалось, имя массива без индекса представляет собой указатель. И наоборот, указатель можно индексировать как массив. Рассмотрим следующий фрагмент программы:
<pre>
int *p, i[10];
p = i;
p[5] = 100;  /* в присваении используется индекс */
*(p+5) = 100; /* в присвоении используется адресная арифметика */
</pre>
<p class="tj">Оба оператора присваивания заносят число 100 в 6-й элемент массива <kbd>i</kbd>. Первый из них индексирует указатель <kbd>p</kbd>, во втором применяются правила адресной арифметики. В обоих случаях получается один и тот же результат. (Подробно указатели и адресная арифметика рассматриваются в <a href="../05/05.htm">главе 5</a>.)
<p class="tj">Можно также индексировать указатели на многомерные массивы. Например, если <kbd>а</kbd> — это указатель на двухмерный массив целых размерностью 10&#215;10, то следующие два выражения эквивалентны:
<pre>a
&a[0][0]</pre>
<p class="tj">Более того, к элементу (0,4)<sup><a href="#11" id="1">[1]</a></sup> можно обратиться двумя способами: либо указав индексы массива: <kbd>а[0][4]</kbd>, либо с помощью указателя: <kbd>*((int*)а+4)</kbd>. Аналогично для элемента (1,2): <kbd>а[1][2]</kbd> или <kbd>*((int*)а+12)</kbd>. В общем виде для двухмерного массива справедлива следующая формула:
<pre>a[j][k] эквивалентно *((<em>базовый_тип</em>*)а+(j*<em>длина_строки</em>)+k)</pre>
<p class="tj">Правила адресной арифметики требуют явного преобразования указателя на массив в указатель на базовый тип (см. <a href="../05/05.htm">главу 5</a>). Указатели используются для обращения к элементам массива потому, что часто операции адресной арифметики выполняются быстрее, чем индексация массива.
<p class="tj">Двухмерный массив может быть представлен как указатель на массив одномерных массивов. Добавив еще один указатель, можно с его помощью обращаться к элементам отдельной строки массива. Этот прием демонстрируется в функции <kbd>pr_row()</kbd>, которая печатает содержимое конкретной строки двухмерного глобального массива <kbd>num</kbd>:
<pre>
int num[10][10];
/* ... */
void  pr_row(int j)
{
  int *p, t;
  p = (int *) &num[j][0]; /* вычисление адреса 1-го
                             элемента строки номер j */
  for(t=0; t&lt;10; ++t) printf("%d ", *(p+t));
}
</pre>
<p class="tj">Эту функцию можно обобщить, включив в список аргументов номер строки, длину строки и указатель на 1-й элемент:
<pre>
void pr_row(int j, int row_dimension, int *p)
{
  int t;
  p = p + (j * row_dimension);
  for(t=0; t&lt;row_dimension; ++t)
    printf("%d ", *(p+t));
}
/* ... */
void f(void)
{
  int num[10][10];
  pr_row(0, 10, (int *) num); /* печать 1-й строки */
}
</pre>
<p class="tj">Такой прием "понижения размерности" годится не только для двухмерных массивов, но и для любых многомерных. Например, вместо того, чтобы работать с трехмерным массивом, можно использовать указатель на двухмерный массив, причем вместо него в свою очередь можно использовать указатель на одномерный массив. В общем случае вместо того, чтобы обращаться к <em>n</em>-мерному массиву, можно работать с указателем на (<em>n-1</em>)-мерный массив. Причем этот процесс понижения размерности кончается на одномерном массиве.
<p><img src="../work/sup.bmp" alt="----------">
<blockquote>
<p class="tj"><sup><a href="#1" id="11">[1]</a></sup>Так обозначается элемент, у которого первая координата равна 0, а вторая — 4.
</blockquote>
<p>
</p>
<hr><a href="../main.htm#04">Содержание</a> | <a href="0406.htm">&lt;&lt;&lt;</a> | <a href="0408.htm">&gt;&gt;&gt;</a>


</body>
</html>
