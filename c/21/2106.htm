<!DOCTYPE HTML>
<html lang="ru">
<head>
<title>Сортировка вставками - cправочник по Си</title>
<meta charset="utf-8">
<link rel="stylesheet" href="../work/css.css">
</head>
<body>


<a href="../main.htm#21">Содержание</a> | <a href="2105.htm">&lt;&lt;&lt;</a> | <a href="2107.htm">&gt;&gt;&gt;</a><hr>
<h1>Сортировка вставками</h1>
<p class="tj"><em>Сортировка вставками</em> — третий и последний из простых алгоритмов сортировки. Сначала он сортирует два первых элемента массива. Затем алгоритм вставляет третий элемент в соответствующую порядку позицию по отношению к первым двум элементам. После этого он вставляет четвертый элемент в список из трех элементов. Этот процесс повторяется до тех пор, пока не будут вставлены все элементы. Например, при сортировке массива <strong>dcab</strong> каждый проход алгоритма будет выглядеть следующим образом:
<pre>
Начало       <strong>d c a b</strong>
Проход 1     <strong>c d a b</strong>
Проход 2     <strong>a c d b</strong>
Проход 3     <strong>a b c d</strong>
</pre>
<p class="tj">Пример реализации сортировки вставками показан ниже:
<pre>
/* Сортировка вставками. */
void insert(char *items, int count)
{
  register int a, b;
  char t;
  for(a=1; a &lt; count; ++a) {
    t = items[a];
    for(b=a-1; (b &gt;= 0) && (t &lt; items[b]); b--)
      items[b+1] = items[b];
    items[b+1] = t;
  }
}
</pre>
<p class="tj">В отличие от пузырьковой сортировки и сортировки посредством выбора, количество сравнений в сортировке вставками зависит от изначальной упорядоченности списка. Если список уже отсортирован, количество сравнений равно <em>n</em>&#160;-&#160;1; в противном случае его производительность является величиной порядка <em>n</em><sup>2</sup>.
<p class="tj">Вообще говоря, в худших случаях сортировка вставками настолько же плоха, как и пузырьковая сортировка и сортировка посредством выбора, а в среднем она лишь немного лучше. Тем не менее, у сортировки вставками есть два преимущества. Во-первых, ее поведение естественно. Другими словами, она работает меньше всего, когда массив уже упорядочен, и больше всего, когда массив отсортирован в обратном порядке. Поэтому сортировка вставками — идеальный алгоритм для почти упорядоченных списков. Второе преимущество заключается в том, что данный алгоритм не меняет порядок одинаковых ключей<sup><a href="#11" id="1">[1]</a></sup>. Это значит, что если список отсортирован по двум ключам, то после сортировки вставками он останется упорядоченным по обоим.
<p class="tj">Несмотря на то, что количество сравнений при определенных наборах данных может быть довольно низким, при каждой вставке элемента на свое место массив необходимо сдвигать. Вследствие этого количество перемещений может быть значительным.
<p><img src="../work/sup.bmp" alt="----------">
<blockquote>
<p class="tj"><sup><a href="#1" id="11">[1]</a></sup>Т.е. устойчив.
</blockquote>
<hr><a href="../main.htm#21">Содержание</a> | <a href="2105.htm">&lt;&lt;&lt;</a> | <a href="2107.htm">&gt;&gt;&gt;</a>


</body>
</html>
